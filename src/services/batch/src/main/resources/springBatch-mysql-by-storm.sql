-- spring-batch-core-3.0.7.RELEASE.jar : org.springframework.batch.core.schema-drop-mysql.sql , org.springframework.batch.core.schema-mysql.sql 에서 스키마를 얻을 수 있다.
-- Autogenerated: do not edit this file

DROP TABLE IF EXISTS BATCH_STEP_EXECUTION_CONTEXT ;
DROP TABLE IF EXISTS BATCH_JOB_EXECUTION_CONTEXT ;
DROP TABLE IF EXISTS BATCH_STEP_EXECUTION ;
DROP TABLE IF EXISTS BATCH_JOB_EXECUTION_PARAMS ;
DROP TABLE IF EXISTS BATCH_JOB_EXECUTION ;
DROP TABLE IF EXISTS BATCH_JOB_INSTANCE ;

DROP TABLE IF EXISTS BATCH_STEP_EXECUTION_SEQ ;
DROP TABLE IF EXISTS BATCH_JOB_EXECUTION_SEQ ;
DROP TABLE IF EXISTS BATCH_JOB_SEQ ;



CREATE TABLE BATCH_JOB_INSTANCE (
	JOB_INSTANCE_ID BIGINT(20) NOT NULL COMMENT '잡 인스턴스 ID',
	VERSION BIGINT(20) NULL DEFAULT NULL COMMENT '버전',
	JOB_NAME VARCHAR(100) NOT NULL COMMENT '잡 이름',
	JOB_KEY VARCHAR(32) NOT NULL COMMENT '잡 키',
	PRIMARY KEY (JOB_INSTANCE_ID),
	UNIQUE INDEX JOB_INST_UN (JOB_NAME, JOB_KEY)
)
COMMENT='배치 잡 인스턴스'
COLLATE='utf8_general_ci'
ENGINE=InnoDB
;

CREATE TABLE BATCH_JOB_EXECUTION (
	JOB_EXECUTION_ID BIGINT(20) NOT NULL COMMENT '잡 실행 ID',
	VERSION BIGINT(20) NULL DEFAULT NULL COMMENT '버전',
	JOB_INSTANCE_ID BIGINT(20) NOT NULL COMMENT '잡 인스턴스 ID',
	CREATE_TIME DATETIME NOT NULL COMMENT '생성 시간',
	START_TIME DATETIME NULL DEFAULT NULL COMMENT '시작 시간',
	END_TIME DATETIME NULL DEFAULT NULL COMMENT '종료 시간',
	STATUS VARCHAR(10) NULL DEFAULT NULL COMMENT '상태',
	EXIT_CODE VARCHAR(100) NULL DEFAULT NULL COMMENT '종료 코드',
	EXIT_MESSAGE VARCHAR(2500) NULL DEFAULT NULL COMMENT '종료 메시지',
	LAST_UPDATED DATETIME NULL DEFAULT NULL COMMENT '최종 수정시간',
	JOB_CONFIGURATION_LOCATION VARCHAR(500) NULL DEFAULT NULL COMMENT '잡 설정 위치',
	PRIMARY KEY (JOB_EXECUTION_ID),
	INDEX JOB_INST_EXEC_FK (JOB_INSTANCE_ID),
	CONSTRAINT JOB_INST_EXEC_FK FOREIGN KEY (JOB_INSTANCE_ID) REFERENCES BATCH_JOB_INSTANCE (JOB_INSTANCE_ID)
)
COMMENT='배치 잡 실행'
COLLATE='utf8_general_ci'
ENGINE=InnoDB
;


CREATE TABLE BATCH_JOB_EXECUTION_PARAMS (
	JOB_EXECUTION_ID BIGINT(20) NOT NULL COMMENT '잡 실행 ID',
	TYPE_CD VARCHAR(6) NOT NULL COMMENT '타입 코드',
	KEY_NAME VARCHAR(100) NOT NULL COMMENT '키 이름',
	STRING_VAL VARCHAR(250) NULL DEFAULT NULL COMMENT 'STRING 값',
	DATE_VAL DATETIME NULL DEFAULT NULL COMMENT 'DATE 값',
	LONG_VAL BIGINT(20) NULL DEFAULT NULL COMMENT 'LONG 값',
	DOUBLE_VAL DOUBLE NULL DEFAULT NULL COMMENT 'DOUBLE 값',
	IDENTIFYING CHAR(1) NOT NULL COMMENT '식별여부',
	INDEX JOB_EXEC_PARAMS_FK (JOB_EXECUTION_ID),
	CONSTRAINT JOB_EXEC_PARAMS_FK FOREIGN KEY (JOB_EXECUTION_ID) REFERENCES BATCH_JOB_EXECUTION (JOB_EXECUTION_ID)
)
COMMENT='배치 잡 실행 인자'
COLLATE='utf8_general_ci'
ENGINE=InnoDB
;

CREATE TABLE BATCH_STEP_EXECUTION (
	STEP_EXECUTION_ID BIGINT(20) NOT NULL COMMENT '스탭 실행 ID',
	VERSION BIGINT(20) NOT NULL COMMENT '버전',
	STEP_NAME VARCHAR(100) NOT NULL COMMENT '스탭 이름',
	JOB_EXECUTION_ID BIGINT(20) NOT NULL COMMENT '잡 실행 ID',
	START_TIME DATETIME NOT NULL COMMENT '시작 시간',
	END_TIME DATETIME NULL DEFAULT NULL COMMENT '종료 시간',
	STATUS VARCHAR(10) NULL DEFAULT NULL COMMENT '상태',
	COMMIT_COUNT BIGINT(20) NULL DEFAULT NULL COMMENT '커밋 건수',
	READ_COUNT BIGINT(20) NULL DEFAULT NULL COMMENT '읽기 건수',
	FILTER_COUNT BIGINT(20) NULL DEFAULT NULL COMMENT '필터 건수',
	WRITE_COUNT BIGINT(20) NULL DEFAULT NULL COMMENT '쓰기 건수',
	READ_SKIP_COUNT BIGINT(20) NULL DEFAULT NULL COMMENT '읽기 스킵 건수',
	WRITE_SKIP_COUNT BIGINT(20) NULL DEFAULT NULL COMMENT '쓰기 스킵 건수',
	PROCESS_SKIP_COUNT BIGINT(20) NULL DEFAULT NULL COMMENT '프로세스 스킵 건수',
	ROLLBACK_COUNT BIGINT(20) NULL DEFAULT NULL COMMENT '롤백 건수',
	EXIT_CODE VARCHAR(100) NULL DEFAULT NULL COMMENT '종료 코드',
	EXIT_MESSAGE VARCHAR(2500) NULL DEFAULT NULL COMMENT '종료 메시지',
	LAST_UPDATED DATETIME NULL DEFAULT NULL COMMENT '최종 수정시간',
	PRIMARY KEY (STEP_EXECUTION_ID),
	INDEX JOB_EXEC_STEP_FK (JOB_EXECUTION_ID),
	CONSTRAINT JOB_EXEC_STEP_FK FOREIGN KEY (JOB_EXECUTION_ID) REFERENCES BATCH_JOB_EXECUTION (JOB_EXECUTION_ID)
)
COMMENT='배치 스탭 실행'
COLLATE='utf8_general_ci'
ENGINE=InnoDB
;

CREATE TABLE BATCH_STEP_EXECUTION_CONTEXT (
	STEP_EXECUTION_ID BIGINT(20) NOT NULL COMMENT '스탭 실행 ID',
	SHORT_CONTEXT VARCHAR(2500) NOT NULL COMMENT '요약 컨텍스트',
	SERIALIZED_CONTEXT TEXT NULL COMMENT '직렬화 컨텍스트',
	PRIMARY KEY (STEP_EXECUTION_ID),
	CONSTRAINT STEP_EXEC_CTX_FK FOREIGN KEY (STEP_EXECUTION_ID) REFERENCES BATCH_STEP_EXECUTION (STEP_EXECUTION_ID)
)
COMMENT='배치 스탭 실행 컨텍스'
COLLATE='utf8_general_ci'
ENGINE=InnoDB
;

CREATE TABLE BATCH_JOB_EXECUTION_CONTEXT (
	JOB_EXECUTION_ID BIGINT(20) NOT NULL COMMENT '잡 실행 ID',
	SHORT_CONTEXT VARCHAR(2500) NOT NULL COMMENT '요약 컨텍스트',
	SERIALIZED_CONTEXT TEXT NULL COMMENT '직렬화 컨텍스트',
	PRIMARY KEY (JOB_EXECUTION_ID),
	CONSTRAINT JOB_EXEC_CTX_FK FOREIGN KEY (JOB_EXECUTION_ID) REFERENCES BATCH_JOB_EXECUTION (JOB_EXECUTION_ID)
)
COMMENT='배치 잡 실행 컨텍스트'
COLLATE='utf8_general_ci'
ENGINE=InnoDB
;

CREATE TABLE BATCH_STEP_EXECUTION_SEQ (
	ID BIGINT(20) NOT NULL COMMENT '스탭 실행 ID',
	UNIQUE_KEY CHAR(1) NOT NULL,
	constraint UNIQUE_KEY_UN unique (UNIQUE_KEY)    
)
COMMENT='배치 스탭 실행 시퀀스'
COLLATE='utf8_general_ci'
ENGINE=InnoDB
;

INSERT INTO BATCH_STEP_EXECUTION_SEQ (ID, UNIQUE_KEY) select * from (select 0 as ID, '0' as UNIQUE_KEY) as tmp where not exists(select * from BATCH_STEP_EXECUTION_SEQ);

CREATE TABLE BATCH_JOB_EXECUTION_SEQ (
	ID BIGINT(20) NOT NULL COMMENT '잡 실행 ID',
	UNIQUE_KEY CHAR(1) NOT NULL,
	constraint UNIQUE_KEY_UN unique (UNIQUE_KEY)    
)
COMMENT='배치 잡 실행 시퀀스'
COLLATE='utf8_general_ci'
ENGINE=InnoDB
;

INSERT INTO BATCH_JOB_EXECUTION_SEQ (ID, UNIQUE_KEY) select * from (select 0 as ID, '0' as UNIQUE_KEY) as tmp where not exists(select * from BATCH_JOB_EXECUTION_SEQ);

CREATE TABLE BATCH_JOB_SEQ (
	ID BIGINT(20) NOT NULL COMMENT '잡 인스턴스 ID',
    UNIQUE_KEY CHAR(1) NOT NULL,
	constraint UNIQUE_KEY_UN unique (UNIQUE_KEY)
)
COMMENT='배치 잡 시퀀스'
COLLATE='utf8_general_ci'
ENGINE=InnoDB
;

INSERT INTO BATCH_JOB_SEQ (ID, UNIQUE_KEY) select * from (select 0 as ID, '0' as UNIQUE_KEY) as tmp where not exists(select * from BATCH_JOB_SEQ);










